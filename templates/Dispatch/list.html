{% extends "base.html" %}
{% block link %}
<link rel="stylesheet" href="{{ url_for('static', filename='/css/table.css') }}" />
{% endblock %}
{% block title %}Dispatches{% endblock %}
{% block main %}
<form id="dispatch-form" action="/dispatch/add" method="post">
<div class="container-fluid m-t70">
  <div class="row">
    <div class="col-md-12">
      <br />
      <div class="card">
        <div class="card-body">
            <div class="table-responsive">
              <table class="table table-bordered mb-0 table-centered">
                <thead class="tHead">
                  <tr>
                    <th scope="col">Id.</th>
                    <th scope="col">
                      <a href="{{ url_for('dispatch.dispatchlist', sort_by='created_at', sort_order='desc' if sort_by == 'created_at' and sort_order == 'asc' else 'asc') }}">
                        Date
                        {% if sort_by == 'created_at' %}
                          {% if sort_order == 'asc' %}
                            &#9650; <!-- Up arrow -->
                          {% else %}
                            &#9660; <!-- Down arrow -->
                          {% endif %}
                        {% endif %}
                      </a>
                    </th>
                    <th scope="col">
                      <a href="{{ url_for('dispatch.dispatchlist', sort_by='delivery_man', sort_order='desc' if sort_by == 'delivery_man' and sort_order == 'asc' else 'asc') }}">
                        Delivery Man
                        {% if sort_by == 'delivery_man' %}
                          {% if sort_order == 'asc' %}
                            &#9650;
                          {% else %}
                            &#9660;
                          {% endif %}
                        {% endif %}
                      </a>
                    </th>
                    <th scope="col">
                      <a href="{{ url_for('dispatch.dispatchlist', sort_by='invoice', sort_order='desc' if sort_by == 'invoice' and sort_order == 'asc' else 'asc') }}">
                        Invoice
                        {% if sort_by == 'invoice' %}
                          {% if sort_order == 'asc' %}
                            &#9650;
                          {% else %}
                            &#9660;
                          {% endif %}
                        {% endif %}
                      </a>
                    </th>
                    <th scope="col">
                      <a href="{{ url_for('dispatch.dispatchlist', sort_by='total', sort_order='desc' if sort_by == 'total' and sort_order == 'asc' else 'asc') }}">
                        Total
                        {% if sort_by == 'total' %}
                          {% if sort_order == 'asc' %}
                            &#9650;
                          {% else %}
                            &#9660;
                          {% endif %}
                        {% endif %}
                      </a>
                    </th>
                    <th scope="col">
                      <a href="{{ url_for('dispatch.dispatchlist', sort_by='paid', sort_order='desc' if sort_by == 'paid' and sort_order == 'asc' else 'asc') }}">
                        Paid
                        {% if sort_by == 'paid' %}
                          {% if sort_order == 'asc' %}
                            &#9650;
                          {% else %}
                            &#9660;
                          {% endif %}
                        {% endif %}
                      </a>
                    </th>
                    <th scope="col">
                      <a href="{{ url_for('dispatch.dispatchlist', sort_by='delivery_status', sort_order='desc' if sort_by == 'delivery_status' and sort_order == 'asc' else 'asc') }}">
                        Delivery Status
                        {% if sort_by == 'delivery_status' %}
                          {% if sort_order == 'asc' %}
                            &#9650;
                          {% else %}
                            &#9660;
                          {% endif %}
                        {% endif %}
                      </a>
                    </th>
                    <th scope="col">
                      <a href="{{ url_for('dispatch.dispatchlist', sort_by='payment_status', sort_order='desc' if sort_by == 'payment_status' and sort_order == 'asc' else 'asc') }}">
                        Payment Status
                        {% if sort_by == 'payment_status' %}
                          {% if sort_order == 'asc' %}
                            &#9650;
                          {% else %}
                            &#9660;
                          {% endif %}
                        {% endif %}
                      </a>
                    </th>
                    <th class="text-center">Action</th>
                  </tr>
                </thead>
                <tbody>
                  {% for dispatch in data %}
                  <tr>
                    <td>{{ dispatch['dispatch_id'] }}</td>
                    <td>{{ dispatch['created_at'] }}</td>
                    <td>{{ dispatch['delivery_man'] }}</td>
                    <td>{{ dispatch['invoice'] }}</td>
                    <td>{{ dispatch['total'] }}</td>
                    <td>{{ dispatch['paid'] }}</td>
                    <td>{{ dispatch['delivery_status'] }}</td>
                    <td>{{ dispatch['payment_status'] }}</td>
                    <td class="text-center">
                      <a href="/dispatch/{{ dispatch['dispatch_id'] }}" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-eye"></i>
                      </a>
                      <a href="/dispatch/edit/{{ dispatch['dispatch_id'] }}" class="btn btn-outline-success btn-sm">
                        <i class="fas fa-edit"></i>
                      </a>
                      <a href="/dispatch/delete/{{ dispatch['dispatch_id'] }}" class="btn btn-outline-danger btn-sm" onclick="return confirm('Are you sure you want to delete this dispatch?');">
                        <i class="fas fa-trash"></i>
                      </a>
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    document.getElementById("select-all").addEventListener("click", function () {
      var isChecked = this.checked;
      document.querySelectorAll(".select-item").forEach(function (checkbox) {
        checkbox.checked = isChecked;
      });
    });
  });
</script>
{% endblock %}
